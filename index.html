<!DOCTYPE html>
<html lang="pt-BR">
<head>

    <meta charset="UTF-8">
    <title>Relat√≥rio T√©cnico</title>
    <meta name="theme-color" content="#0f172a">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="stylesheet" type="text/css" href="css/estilo.css">

</head>

<header>

</header>

<body class="dark">
    <div>
    <nav>

    <form class="container" onsubmit="event.preventDefault()">

    <div class="topbar">
      <h2>Relat√≥rio T√©cnico</h2>
      <div class="toggle" onclick="toggleTema()">üåô / ‚òÄÔ∏è</div>
    </div>

    <!-- STEP 1 -->
    <section class="step" data-step="1">
    <h3>Identifica√ß√£o</h3>
    <div class="grid">
      <div><label>Local *</label><input id="local"></div>
      <div><label>WOT *</label><input id="wot"></div>
      <div><label>Respons√°vel *</label><input id="responsavel"></div>
      <div><label>Fun√ß√£o *</label><input id="funcao"></div>
    </div>
    <div class="buttons">
      <button class="next" onclick="nextStep()">Pr√≥ximo</button>
    </div>
    </section>

    <!-- STEP 2 -->
    <section class="step" data-step="2" style="display:none;">
    <h3>Descri√ß√£o T√©cnica</h3>

    <h4>Problemas</h4>
    <div id="boxProblemas" class="box"></div>

    <input id="novoProblema" placeholder="Adicionar novo problema">
    <button class="next" onclick="addCustom('problemas')">Adicionar problema</button>

    <button class="next" onclick="addChecked('problemas')">Adicionar selecionados</button>
    <ul id="listaProblemas" class="lista"></ul>

    <hr>

    <h4>Solu√ß√µes</h4>
    <div id="boxSolucoes" class="box"></div>

    <input id="novaSolucao" placeholder="Adicionar nova solu√ß√£o">
    <button class="next" onclick="addCustom('solucoes')">Adicionar solu√ß√£o</button>

    <button class="next" onclick="addChecked('solucoes')">Adicionar selecionadas</button>
    <ul id="listaSolucoes" class="lista"></ul>

    <div class="buttons">
      <button class="back" onclick="prevStep()">Voltar</button>
      <button class="next" onclick="validarStep2()">Pr√≥ximo</button>
    </div>
    </section>

    <!-- STEP 3 -->
    <section class="step" data-step="3" style="display:none;">
    <h3>Finaliza√ß√£o</h3>

    <label>Status *</label>
    <select id="status">
      <option value="">Selecione</option>
      <option>Produtivo</option>
      <option>Improdutivo</option>
    </select>

    <div class="buttons">
      <button class="back" onclick="prevStep()">Voltar</button>
      <button class="next" onclick="gerarRelatorio()">Gerar Relat√≥rio</button>
    </div>

    <pre id="resultado"></pre>

    <div class="buttons">
      <button class="copy" onclick="copiar()">Copiar</button>
    </div>
    </section>

    </form>

    <script>
    let step=1;

    // Op√ß√µes fixas
    let problemasFixos=JSON.parse(localStorage.getItem("problemasFixos"))||[
      "Falha de autentica√ß√£o","Servi√ßo parado","Erro de permiss√£o","Falha de conex√£o"
    ];
    let solucoesFixas=JSON.parse(localStorage.getItem("solucoesFixas"))||[
      "Rein√≠cio do servi√ßo","Ajuste de permiss√µes","Corre√ß√£o de configura√ß√£o","Atualiza√ß√£o do sistema"
    ];

    // Listas adicionadas
    let problemas=JSON.parse(localStorage.getItem("problemas"))||[];
    let solucoes=JSON.parse(localStorage.getItem("solucoes"))||[];

    // Navega√ß√£o
    function mostrar(s){
      document.querySelectorAll(".step").forEach(e=>e.style.display="none");
      document.querySelector(`[data-step="${s}"]`).style.display="block";
      step=s;
    }
    function nextStep(){mostrar(step+1)}
    function prevStep(){mostrar(step-1)}
    function toggleTema(){document.body.classList.toggle("dark")}

    // Render fixos
    function renderFixos(){
      boxProblemas.innerHTML=problemasFixos.map((p,i)=>
        `<label><input type="checkbox" value="${p}"> ${p} <small onclick="removerFixo('problemas',${i})">‚úñ</small></label>`
      ).join("");

      boxSolucoes.innerHTML=solucoesFixas.map((s,i)=>
        `<label><input type="checkbox" value="${s}"> ${s} <small onclick="removerFixo('solucoes',${i})">‚úñ</small></label>`
      ).join("");
    }

    // Adicionar checkboxes selecionados
    function addChecked(tipo){
      document.querySelectorAll(`#box${cap(tipo)} input:checked`).forEach(c=>{
        const arr=tipo==="problemas"?problemas:solucoes;
        if(!arr.includes(c.value)) arr.push(c.value);
        c.checked=false;
      });
      salvar();
    }

    // Adicionar personalizado
    function addCustom(tipo){
      const input=tipo==="problemas"?novoProblema:novaSolucao;
      if(!input.value.trim()) return;
      const fixos=tipo==="problemas"?problemasFixos:solucoesFixas;
      fixos.push(input.value.trim());
      input.value="";
      salvarFixos();
    }

    // Remover fixos
    function removerFixo(tipo,i){
      (tipo==="problemas"?problemasFixos:solucoesFixas).splice(i,1);
      salvarFixos();
    }

    // Render listas adicionadas
    function renderLista(tipo){
      const arr=tipo==="problemas"?problemas:solucoes;
      document.getElementById("lista"+cap(tipo)).innerHTML=
        arr.map((e,i)=>`<li>${e} <span onclick="remover('${tipo}',${i})">‚úñ</span></li>`).join("");
    }

    // Remover item adicionado
    function remover(tipo,i){
      (tipo==="problemas"?problemas:solucoes).splice(i,1);
      salvar();
    }

    // Salvar listas
    function salvar(){
      localStorage.setItem("problemas",JSON.stringify(problemas));
      localStorage.setItem("solucoes",JSON.stringify(solucoes));
      renderLista("problemas");
      renderLista("solucoes");
    }

    // Salvar fixos
    function salvarFixos(){
      localStorage.setItem("problemasFixos",JSON.stringify(problemasFixos));
      localStorage.setItem("solucoesFixas",JSON.stringify(solucoesFixas));
      renderFixos();
    }

    // Validar STEP2 antes de avan√ßar
    function validarStep2(){
      if(problemas.length===0){ alert("Adicione pelo menos um PROBLEMA."); return; }
      if(solucoes.length===0){ alert("Adicione pelo menos uma SOLU√á√ÉO."); return; }
      nextStep();
    }

    // Gerar relat√≥rio
    function gerarRelatorio(){
      const statusValue = document.getElementById("status").value;

      if(!local.value || !wot.value || !responsavel.value || !funcao.value){
        alert("Preencha todos os campos de identifica√ß√£o."); return;
      }
      if(problemas.length===0){ alert("Adicione pelo menos um PROBLEMA."); return; }
      if(solucoes.length===0){ alert("Adicione pelo menos uma SOLU√á√ÉO."); return; }
      if(!statusValue){ alert("Selecione o STATUS."); return; }

      resultado.innerText = `DATA: ${new Date().toLocaleString("pt-BR")}


    LOCAL: ${local.value}
    WOT${wot.value}
    RESPONS√ÅVEL: ${responsavel.value}
    FUN√á√ÉO: ${funcao.value}
    STATUS: ${statusValue}

    PROBLEMAS IDENTIFICADOS:
    ${problemas.map(p=>"- "+p).join("\n")}

    SOLU√á√ïES APLICADAS:
    ${solucoes.map(s=>"- "+s).join("\n")}`;
    }

    // Copiar
    function copiar(){navigator.clipboard.writeText(resultado.innerText); alert("Copiado!");}

    // Capitalizar tipo
    function cap(t){return t.charAt(0).toUpperCase()+t.slice(1)}

    // Inicializar
    renderFixos();
    renderLista("problemas");
    renderLista("solucoes");
    mostrar(1);
    </script>

    </nav>

        <!--Rodape-->
        
        <footer id="footer">
            &copy; Copyright 2026 B.I.T solu√ß√µes em T.I
        </footer>

    </div>

</body>
</html>
